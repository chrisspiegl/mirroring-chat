(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0052f2cc"],{"0a56":function(e,t,a){"use strict";var s=a("31d7"),i=a.n(s);i.a},2919:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"pa-0 my-0 fill-height"},[a("div",{staticClass:"boxToFillHeight"},[a("div",[a("v-toolbar",{attrs:{dense:""}},[a("v-card-title",{staticClass:"justify-center"},[e._v("All Chat Messages")])],1)],1),a("v-row",[a("v-col",[a("div",{staticClass:"boxToFillHeight",staticStyle:{height:"100%"}},[a("v-card",[a("v-toolbar",{attrs:{dense:""}},[a("v-toolbar-title",[e._v(e._s(e.chatMessagesUndone.length)+" Unacknoweledged Messages")])],1)],1),a("div",{staticClass:"chat-container"},[a("vue-scroll",{ref:"vuescrollDone",attrs:{ops:e.vuescrollOptionsDone}},[e._l(e.chatMessagesUndone,(function(t,s){return e.chatMessagesUndone.length>0?a("message",{key:t.idChatMessage,attrs:{provider:t.provider,message:t,index:s,actionMessageDone:e.actionMessageDone,actionMessageReply:e.actionMessageReply,actionUserBan:e.actionUserBan,actionUserTimeout:e.actionUserTimeout,actionMessageHighlight:e.actionMessageHighlight}}):e._e()})),0===e.chatMessagesUndone.length&&0!==e.chatMessages.length?a("v-card",{staticClass:"mb-2"},[a("v-card-title",{staticClass:"justify-center"},[e._v("INBOX ZERO")]),a("v-card-subtitle",{staticClass:"text-center"},[e._v("You reached the bottom.")])],1):e._e(),0===e.chatMessagesUndone.length&&0===e.chatMessages.length?a("v-card",{staticClass:"mb-2"},[a("v-card-title",{staticClass:"justify-center"},[e._v("Nothing yet…")]),a("v-card-subtitle",{staticClass:"text-center"},[e._v("Invite some people to your strem and let's chat.")])],1):e._e()],2)],1)],1)]),a("v-col",[a("div",{staticClass:"boxToFillHeight",staticStyle:{height:"100%"}},[a("v-card",[a("v-toolbar",{attrs:{dense:""}},[a("v-toolbar-title",[e._v("Live Chat with "+e._s(e.chatMessagesReversed.length)+" Messages")])],1)],1),a("div",{staticClass:"chat-container"},[a("vue-scroll",{ref:"vuescrollLive",attrs:{ops:e.vuescrollOptionsLive}},[e._l(e.chatMessagesReversed,(function(t,s){return e.chatMessagesReversed.length>0?a("message",{key:t.idChatMessage,style:{opacity:t.doneAt?.5:1},attrs:{provider:t.provider,message:t,index:s,actionMessageDone:e.actionMessageDone,actionMessageReply:e.actionMessageReply,actionUserBan:e.actionUserBan,actionUserTimeout:e.actionUserTimeout,actionMessageHighlight:e.actionMessageHighlight}}):e._e()})),0===e.chatMessagesReversed.length?a("v-card",{staticClass:"mb-2"},[a("v-card-title",{staticClass:"justify-center"},[e._v("Nothing yet…")]),a("v-card-subtitle",{staticClass:"text-center"},[e._v("Invite some people to your strem and let's chat.")])],1):e._e()],2)],1)],1)])],1),a("div",[a("v-toolbar",{attrs:{dense:""}},[a("v-text-field",{ref:"newMessageText",attrs:{label:"Send Message","hide-details":"auto"},model:{value:e.newMessageText,callback:function(t){e.newMessageText=t},expression:"newMessageText"}}),a("v-btn-toggle",{staticClass:"mx-4"},[a("v-btn",{attrs:{color:"primary",title:"Send to All"},on:{click:function(t){return e.sendMessage("all")}}},[a("v-icon",{attrs:{size:"1rem"}},[e._v("$chat")])],1),a("v-btn",{staticClass:"twitch-bg",attrs:{title:"Send to Twitch"},on:{click:function(t){return e.sendMessage("twitch")}}},[a("v-icon",{attrs:{size:"1rem"}},[e._v("$twitch")])],1),a("v-btn",{staticClass:"youtube-bg",attrs:{title:"Send to YouTube"},on:{click:function(t){return e.sendMessage("youtube")}}},[a("v-icon",{attrs:{size:"1rem"}},[e._v("$youtube")])],1)],1),e.chatMessagesLastUpdated&&e.chatMessages.length>0?a("span",[e._v("Last updated "),a("abbr",{attrs:{title:e.dateFormat(e.chatMessagesLastUpdated)}},[e._v(e._s(e.dateFormatRelative(e.chatMessagesLastUpdated,e.time)))])]):e._e()],1)],1)],1)])},i=[],n=a("2f62"),r=a("d84b"),o=a("3597"),c=a("75a6"),l=a("e1e5"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-expand-transition",[a("v-card",{staticClass:"mb-2",class:e.message.provider+"-bg",attrs:{outlined:""}},[a("v-list-item",[a("v-list-item-avatar",{staticClass:"mr-2 my-0",attrs:{size:"30"}},[a("v-img",{attrs:{src:e.avatar(e.message)}})],1),a("v-list-item-content",[a("v-list-item-title",[a("a",{attrs:{href:e.profileLink(e.message),target:"_blank"}},[a("v-icon",{attrs:{size:"1rem"}},[e._v("$"+e._s(e.message.provider))]),e._v("/"+e._s(e.message.displayName))],1)])],1),a("v-list-item-action-text",[a("v-card-actions",[a("v-btn",{attrs:{icon:"",title:"Ban"},on:{click:function(t){return e.actionUserBan(e.index,e.message)}}},[a("v-icon",[e._v("$ban")])],1),a("v-btn",{attrs:{icon:"",title:"Timeout"},on:{click:function(t){return e.actionUserTimeout(e.index,e.message)}}},[a("v-icon",[e._v("$timeout")])],1),a("v-btn",{attrs:{icon:"",title:"Highlight this message"},on:{click:function(t){return e.actionMessageHighlight(e.index,e.message)}}},[a("v-icon",[e._v("$highlight")])],1),a("v-btn",{attrs:{icon:"",title:"Reply to this message"},on:{click:function(t){return e.actionMessageReply(e.index,e.message)}}},[a("v-icon",[e._v("$reply")])],1),a("v-btn",{attrs:{icon:"",title:"Archive"},on:{click:function(t){return e.actionMessageDone(e.index,e.message)}}},[a("v-icon",[e._v("$check")])],1)],1)],1)],1),a("v-card-text",[a("v-list-item-action-text",{staticStyle:{float:"right"}},[a("abbr",{attrs:{title:e.dateFormat(e.parseISO(e.message.sentAt))}},[e._v(e._s(e.dateFormatStrict(e.parseISO(e.message.sentAt),e.time)))])]),a("div",{domProps:{innerHTML:e._s(e.message.message)}})],1)],1)],1)},g=[],u=a("e3ee"),h=a("2420"),v=a("2613"),m=a("fd3a"),b=a("a959"),p=a("7a60"),f=a("8923"),M=a("8c86"),y=1440,x=43200,w=525600;function _(e,t,a){Object(M["a"])(2,arguments);var s=a||{},i=s.locale||f["a"];if(!i.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var n=Object(v["a"])(e,t);if(isNaN(n))throw new RangeError("Invalid time value");var r,o,c=Object(p["a"])(s);c.addSuffix=Boolean(s.addSuffix),c.comparison=n,n>0?(r=Object(m["a"])(t),o=Object(m["a"])(e)):(r=Object(m["a"])(e),o=Object(m["a"])(t));var l,d=null==s.roundingMethod?"round":String(s.roundingMethod);if("floor"===d)l=Math.floor;else if("ceil"===d)l=Math.ceil;else{if("round"!==d)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");l=Math.round}var g,u=Object(b["a"])(o,r),_=(Object(h["a"])(o)-Object(h["a"])(r))/1e3,T=l((u-_)/60);if(g=null==s.unit?T<1?"second":T<60?"minute":T<y?"hour":T<x?"day":T<w?"month":"year":String(s.unit),"second"===g)return i.formatDistance("xSeconds",u,c);if("minute"===g)return i.formatDistance("xMinutes",T,c);if("hour"===g){var C=l(T/60);return i.formatDistance("xHours",C,c)}if("day"===g){var $=l(T/y);return i.formatDistance("xDays",$,c)}if("month"===g){var O=l(T/x);return i.formatDistance("xMonths",O,c)}if("year"===g){var U=l(T/w);return i.formatDistance("xYears",U,c)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function T(e,t=new Date){return _(e,t,{addSuffix:!0})}var C={props:["message","provider","index","actionMessageDone","actionMessageReply","actionUserBan","actionUserTimeout","actionMessageHighlight"],computed:{...Object(n["c"])(["getProfile","isAuthenticated","isProfileLoaded"]),...Object(n["d"])({channelName:e=>e.user.profile.idUser,user:e=>e.user.profile,time:e=>e.time.now})},methods:{dateFormatRelative:o["a"],dateFormatStrict:T,dateFormat:c["a"],parseISO:u["a"],profileLink(e){switch(e.provider){case"twitch":return e.providerObject.userstate.username?"https://twitch.tv/"+e.providerObject.userstate.username:"#";case"youtube":return e.providerObject.authorDetails.channelUrl;default:return"#"}},avatar(e){let t=`https://api.adorable.io/avatars/285/${e.displayName}.png`;switch(e.provider){case"twitch":e.providerObject&&e.providerObject.userHelix&&(t=e.providerObject.userHelix.profile_image_url);break;case"youtube":t=e.providerObject.authorDetails.profileImageUrl;break;default:break}return t}}},$=C,O=(a("7243"),a("2877")),U=a("6544"),j=a.n(U),k=a("8336"),D=a("b0af"),V=a("99d9"),R=a("0789"),N=a("132d"),S=a("adda"),F=a("da13"),L=a("5d23"),I=a("8270"),H=Object(O["a"])($,d,g,!1,null,null,null),B=H.exports;j()(H,{VBtn:k["a"],VCard:D["a"],VCardActions:V["b"],VCardText:V["d"],VExpandTransition:R["e"],VIcon:N["a"],VImg:S["a"],VListItem:F["a"],VListItemActionText:L["e"],VListItemAvatar:I["a"],VListItemContent:L["g"],VListItemTitle:L["k"]});var A={components:{Message:B},computed:{...r["a"],...r["c"],...Object(n["d"])({channelName:e=>e.auth.userCurrent.idUser,time:e=>e.time.now})},data(){return{newMessageText:"",vuescrollOptionsDone:{scrollPanel:{scrollingX:!1,scrollingY:!0}},vuescrollOptionsLive:{scrollPanel:{scrollingX:!1,scrollingY:!0}}}},mounted(){this.$log.debug("Chat.vue mounted"),this.fetchChatMessages()},watch:{chatMessages(e){this.$log.debug("Currently displaying "+e.length)}},methods:{...r["d"],dateFormat:c["a"],dateFormatRelative:o["a"],sendMessage(e){if(!this.newMessageText||""===this.newMessageText.trim())return this.$toast("Message can not be empty!");const t={provider:e,text:this.newMessageText};return Object(l["a"])({method:"post",url:"/v1/chat/send",data:t}).then(e=>{this.$toast(e.message),this.newMessageText=""}).catch(e=>{this.$log.error("error while sending message",e)})},actionMessageDone(e,t){this.markChatMessageDone(t).then(()=>{this.$toast(`Message by ${t.displayName} marked done.`)}).catch(e=>{this.$log.error("PUT /v1/chat/message/"+t.idChatMessage,e)})},actionMessageReply(e,t){this.newMessageText=`@${t.displayName} `,this.$refs.newMessageText.focus()},async actionUserBan(e,t){const a=await this.$confirm(`Do you really want to ban <b>${t.displayName}</b>?`,{color:"error",title:"Banning - "+t.displayName,buttonTrueText:"Yes",buttonFalseText:"No"});a&&this.banChatMessage(t).then(e=>{console.log("actionMessageReply -> resp",e),this.$toast(e.message)}).catch(e=>{this.$toast(`Failed to ban ${t.displayName} from the live chat.`),this.$log.error("Failed to ban user",e)})},async actionUserTimeout(e,t){const a=await this.$confirm(`Do you really want to send <b>${t.displayName}</b> into timeout?`,{color:"warning",title:"Timeout for "+t.displayName,buttonTrueText:"Yes",buttonFalseText:"No"});a&&this.banChatMessage(t).then(e=>{this.$toast(`Sent ${t.displayName} into timeout.`)}).catch(e=>{this.$toast(`Failed to timeout ${t.displayName} from the live chat.`),this.$log.error("Failed to timeout user",e)})},actionMessageHighlight(e,t){}},updated(){}},E=A,Y=(a("0a56"),a("a609")),z=a("62ad"),P=a("a523"),X=a("0fd9"),J=a("8654"),Z=a("71d9"),q=a("2a7f"),G=Object(O["a"])(E,s,i,!1,null,"61ed0758",null);t["default"]=G.exports;j()(G,{VBtn:k["a"],VBtnToggle:Y["a"],VCard:D["a"],VCardSubtitle:V["c"],VCardTitle:V["e"],VCol:z["a"],VContainer:P["a"],VIcon:N["a"],VRow:X["a"],VTextField:J["a"],VToolbar:Z["a"],VToolbarTitle:q["c"]})},"31d7":function(e,t,a){},7243:function(e,t,a){"use strict";var s=a("943b"),i=a.n(s);i.a},"943b":function(e,t,a){}}]);